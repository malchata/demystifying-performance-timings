<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="robots" content="noindex, nofollow, nocache">
    <title>Demystifying Performance Timings</title>
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/mystifying.css?v=1">
    <link rel="stylesheet" href="lib/css/zenburn.css">
  </head>
  <body>
    <a class="twitter" href="https://twitter.com/malchata" rel="noopener">@malchata</a>
    <!--
      // TODO: Add ToC later
    -->
    <div class="reveal">
      <div class="slides">
        <!-- [0.0] - Intro -->
        <section>
          <!-- [0.1] - Title Card -->
          <section data-state="title-card">
            <div class="title-container">
              <h1 class="accent">Demystifying</h1>
              <h2>Performance timings</h2>
              <hr>
              <h4 class="lowercase"><em>by Jeremy Wagner &mdash; <a href="https://twitter.com/malchata" rel="noopener">@malchata</a> &mdash; <a href="https://jeremywagner.me/" rel="noopener">jeremywagner.me</a></em></h4>
            </div>
          </section>
          <!-- [0.2] - Hello! -->
          <section>
            <div class="flex-item-container">
              <div>
                <h1 class="accent">Hello,</h1>
                <h3 class="lowercase">I'm Jeremy!</h3>
              </div>
              <img src="img/me.jpg" alt="Jeremy Wagner speaking at a conference.">
            </div>
          </section>
        </section>
        <!-- [1.0] -->
        <section>
          <!-- [1.1] -->
          <section data-state="section-slide">
            <h1 class="accent">Regarding</h1>
            <h2>Testing methods</h2>
          </section>
          <!-- [1.2] -->
          <section data-state="centered">
            <h1>Synthetic testing</h1>
            <h3 class="lowercase fragment">(or <em>lab data</em>)</h3>
          </section>
          <!-- [1.3] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/lighthouse-2x.webp 2x, img/lighthouse-1x.webp 1x" type="image/webp">
              <source srcset="img/lighthouse-2x.png 2x, img/lighthouse-1x.png 1x" type="image/png">
              <img src="img/lighthouse-2x.png" alt="A screenshot of Chrome's Lighthouse audit in action.">
            </picture>
            <h4 class="lowercase"><em>Lighthouse</em></h4>
          </section>
          <!-- [1.4] -->
          <section>
            <h1 class="accent">The case for:</h1>
            <ul>
              <li class="fragment">It's <em>easy to do</em>.</li>
              <li class="fragment">Great for spot checking performance in dev environments. <span class="fragment">(With network throttling, of course.)</span></li>
              <li class="fragment">Easy to measure the effect of code changes on performance due to consistent baselines.</li>
            </ul>
          </section>
          <!-- [1.5] -->
          <section>
            <h1 class="accent">The case against:</h1>
            <h3 class="lowercase fragment">It doesn't necessarily reflect what <em>real users</em> are <em>experiencing</em>.</h3>
          </section>
          <!-- [1.6] -->
          <section data-state="centered">
            <h1>Enter RUM</h1>
          </section>
          <!-- [1.7] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/cheap-rum.webp" type="image/webp">
              <img src="img/cheap-rum.png" alt="A bottle of cheap rum.">
            </picture>
            <h3 class="lowercase fragment">(No, not <em>this</em>.)</h3>
          </section>
          <!-- [1.8] -->
          <section data-state="centered">
            <h1><u>R</u>eal <u>U</u>ser <u>M</u>etrics</h1>
            <h3 class="lowercase fragment">(or <em>field data</em>)</h3>
          </section>
          <!-- [1.9] -->
          <section>
            <h1 class="accent">The case for:</h1>
            <h3 class="lowercase fragment">You're gathering metrics from <em>real users</em> who are using your site/app.</h3>
          </section>
          <!-- [1.10] -->
          <section>
            <h1 class="accent">The case against:</h1>
            <h3 class="lowercase fragment">It's not as convenient.</h3>
          </section>
          <!-- [1.11] -->
          <section>
            <pre><code class="javascript">performance.getEntriesByType("navigation").forEach((navigation) => {
  console.dir(navigation);
});</code></pre>
          </section>
          <!-- [1.12] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/navigation-timing-2x.webp 2x, img/navigation-timing-1x.webp 1x" type="image/webp">
              <source srcset="img/navigation-timing-2x.png 2x, img/navigation-timing-1x.png 1x" type="image/png">
              <img src="img/navigation-timing-2x.png" alt="A screenshot of a navigation timing entry in Chrome.">
            </picture>
          </section>
          <!-- [1.13] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/cry.webp" type="image/webp">
              <img class="stretch" src="img/cry.gif" alt="An animated image of a man crying.">
            </picture>
          </section>
        </section>
        <!-- [2.0] -->
        <section>
          <!-- [2.] -->
          <section data-state="centered">
            <h1 class="accent">Navigation</h1>
            <h2 class="accent">and</h2>
            <h1 class="accent">Resource Timing</h1>
          </section>
          <!-- [2.] -->
          <section>
            <h1 class="accent">Navigation timing</h1>
            <h3>Gathers page metrics.</h3>
            <h4 class="fragment lowercase"><em>(Usually HTML documents.)</em></h4>
          </section>
          <!-- [2.] -->
          <section>
            <h1 class="accent">Resource timing</h1>
            <h3>Gathers resource metrics.</h3>
            <h4 class="fragment lowercase"><em>(CSS, JavaScript, images, et cetera.)</em></h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Processing Model</h2>
            <img class="stretch" src="img/nav-timing-processing-model.svg" alt="Navigation timing processing model diagram.">
            <h5 class="lowercase"><em><a href="https://www.w3.org/TR/navigation-timing-2/#processing-model" rel="noopener">w3.org/TR/navigation-timing-2/#processing-model</a></em></h5>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Unload</h2>
            <h4 class="lowercase">When the document unloads.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/unload.webp" type="image/webp">
              <img class="larger stretch" src="img/unload.gif" alt="An animated image of a truck throwing stuff out the back using inertia.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>Unload</h3>
            <img src="img/nav-timing-unload.svg" alt="Navigation timing processing model diagram with the unload phase highlighted.">
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h2>unload metrics</h2>
            <ul>
              <li class="fragment"><code>startTime</code> is always <code>0</code>.</li>
              <li class="fragment"><code>unloadEventStart</code> may be <code>0</code> if there is no previous document, or if a previous document (or redirect) is not from the same origin.</li>
              <li class="fragment"><code>unloadEventEnd</code> can overlap with other events (e.g., connect, redirect).</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Redirect</h2>
            <h4 class="lowercase">When a navigation encounters one (or more) HTTP 300 level status codes.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/cat-chasing-tail.webp" type="image/webp">
              <img class="larger stretch" src="img/cat-chasing-tail.gif" alt="An animated image of a cat chasing its tail.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/redirect-2x.webp 2x, img/redirect-1x.webp 1x" type="image/webp">
              <source srcset="img/redirect-2x.png 2x, img/redirect-1x.png 1x" type="image/png">
              <img class="stretch" src="img/redirect-2x.png" alt="A screenshot of redirects mapped out in Chrome dev tools.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>Redirect*</h3>
            <img src="img/nav-timing-redirect.svg" alt="Navigation timing processing model diagram with the redirect phase highlighted.">
            <h5 class="fragment lowercase"><em>*Resource timing API processing model <u>begins</u> here.</em></h5>
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>Redirect metrics</h3>
            <ul>
              <li class="fragment"><code>redirectStart</code> and <code>redirectEnd</code> will be <code>0</code> if no redirects occur.</li>
              <li class="fragment">Redirects from and to other origins can still come up as <code>0</code> if the <code><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin" rel="noopener">Timing-Allow-Origin</a></code> header isn't set.</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>App Cache</h2>
            <h4 class="lowercase">When the browser begins to fetch an item.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/fetch.webp" type="image/webp">
              <img class="larger stretch" src="img/fetch.gif" alt="An animated image of a person pushing a dog along the floor toward a ball.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>App Cache</h3>
            <img src="img/nav-timing-appcache.svg" alt="Navigation timing processing model diagram with the app cache phase highlighted.">
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>App Cache metrics</h3>
            <ul>
              <li class="fragment">Regardless of caching, <code>fetchStart</code> begins about the same time.</li>
              <li class="fragment">If an item is cached, metrics that come after <code>fetchStart</code> (e.g., <code>connectStart</code>, et cetera) will occur very nearly after.</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Cached <span class="lowercase">vs.</span> uncached</h2>
            <img class="stretch" src="img/appcache-differences.svg" alt="Differences in app cache performance timing phases for cached and uncached resources.">
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>DNS</h2>
            <h4 class="lowercase">When DNS lookups occur.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/gandalf.webp" type="image/webp">
              <img src="img/gandalf.jpg" alt="Gandalf reading out of a giant book.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/connection-time-2x.webp 2x, img/connection-time-1x.webp 1x" type="image/webp">
              <source srcset="img/connection-time-2x.png 2x, img/connection-time-1x.png 1x" type="image/png">
              <img class="larger stretch" src="img/connection-time-2x.png" alt="A screenshot of connection phases and times for a page resource in Chrome dev tools.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>DNS</h3>
            <img src="img/nav-timing-dns.svg" alt="Navigation timing processing model diagram with the DNS phase highlighted.">
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>DNS metrics</h3>
            <ul>
              <li class="fragment">DNS lookups can be cached at multiple levels:</li>
              <ul>
                <li class="fragment">Browser.</li>
                <li class="fragment">System.</li>
                <li class="fragment">Router.</li>
                <li class="fragment">ISP.</li>
                <li class="fragment"><em>et al.</em></li>
              </ul>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Connection</h2>
            <h4 class="lowercase">When connections are established.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/handshake.webp" type="image/webp">
              <img class="stretch larger" src="img/handshake.jpg" alt="Two men doing an awkward secret handshake.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/connection-time-2x.webp 2x, img/connection-time-1x.webp 1x" type="image/webp">
              <source srcset="img/connection-time-2x.png 2x, img/connection-time-1x.png 1x" type="image/png">
              <img class="larger stretch" src="img/connection-time-2x.png" alt="A screenshot of connection phases and times for a page resource in Chrome dev tools.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>Connection</h3>
            <img src="img/nav-timing-tcp.svg" alt="Navigation timing processing model diagram with the TCP phase highlighted.">
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>Connection metrics</h3>
            <ul>
              <li class="fragment">Connections can be reused.</li>
              <li class="fragment"><code>secureConnectionStart</code> will be <code>0</code> for non-secure sites.</li>
              <li class="fragment"><code>secureConnectionStart</code> can be <code>0</code> if TLS sessions are resumed.</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Request/Response</h2>
            <h4 class="lowercase">When requests are made, and when responses begin/end.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <img class="larger" src="img/cheeseball.gif" alt="Two men throwing cheeseballs in each others' mouths.">
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/request-response-2x.webp 2x, img/request-response-1x.webp 1x" type="image/webp">
              <source srcset="img/request-response-2x.png 2x, img/request-response-1x.png 1x" type="image/png">
              <img class="stretch" src="img/request-response-2x.png" alt="A screenshot of request and response metrics mapped out in Chrome dev tools.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>Request/Response*</h3>
            <img src="img/nav-timing-request-response.svg" alt="Navigation timing processing model diagram with the request and response phases highlighted.">
            <h5 class="fragment lowercase"><em>*Resource timing API processing model <u>ends</u> here.</em></h5>
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>Request/Response metrics</h3>
            <ul>
              <li class="fragment"><code>requestStart</code> denotes the start of a request.</li>
              <li class="fragment"><code>responseStart</code> and <code>responseEnd</code> denote the start and end of a response, respectively.</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Processing</h2>
            <h4 class="lowercase">When the DOM is being processed.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/baking.webp" type="image/webp">
              <img class="stretch larger" src="img/baking.gif" alt="A time-lapse of cookies baking.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>Processing</h3>
            <img src="img/nav-timing-processing.svg" alt="Navigation timing processing model diagram with the processing phase highlighted.">
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>Processing metrics</h3>
            <ul>
              <li class="fragment"><code>domInteractive</code> marks when the browser has finished HTML parsing and DOM construction.</li>
              <li class="fragment"><code>domContentLoadedEventStart</code> and <code>domContentLoadedEventEnd</code> marks when the DOM is ready.</li>
              <li class="fragment"><code>domComplete</code> marks when everything has loaded.</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>Processing metrics (<span class="lowercase"><em>continued</em></span>)</h3>
            <ul>
              <li class="fragment"><code>domInteractive</code> and <code>domContentLoadedEventStart</code> occur around the same time.</li>
              <li class="fragment">Depending on front end architecture complexity, <code>domComplete</code> often occurs some time after <code>domContentLoadedEventEnd</code>.</li>
            </ul>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/dom-metrics-2x.webp 2x, img/dom-metrics-1x.webp 1x" type="image/webp">
              <source srcset="img/dom-metrics-2x.png 2x, img/dom-metrics-1x.png 1x" type="image/png">
              <img class="stretch" src="img/dom-metrics-2x.png" alt="A screenshot of redirects mapped out in Chrome dev tools.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h2>Load</h2>
            <h4 class="lowercase">When the page and all of its resources are fully loaded.</h4>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/loading.webp" type="image/webp">
              <img class="stretch larger" src="img/loading.gif" alt="A truck loading fail.">
            </picture>
          </section>
          <!-- [2.] -->
          <section data-state="centered">
            <h3>Load</h3>
            <img src="img/nav-timing-load.svg" alt="Navigation timing processing model diagram with the load phase highlighted.">
          </section>
          <!-- [2.] -->
          <section>
            <h2 class="accent">Regarding</h2>
            <h3>Load metrics</h3>
            <ul>
              <li class="fragment"><code>loadEventStart</code> usually occurs briefly after <code>domComplete</code>.</li>
              <li class="fragment"><code>loadEventEnd</code> signifies when the page has <em>completely</em> finished loading.</li>
            </ul>
          </section>
        </section>
        <!-- [3.0] -->
        <section>
          <!-- [3.] -->
          <section>
            <h1 class="accent">The little bits!</h1>
          </section>
          <!-- [3.] -->
          <section data-state="centered">
            <h2><code>name</code></h2>
            <h3 class="lowercase">The URL of a document or resource.</h3>
          </section>
          <!-- [3.] -->
          <section data-state="centered">
            <h2><code>transferSize</code></h2>
            <h3 class="lowercase">The size of a resource including headers.</h3>
          </section>
          <!-- [3.] -->
          <section data-state="centered">
            <picture>
              <source srcset="img/http-headers.webp" type="image/webp">
              <img src="img/http-headers.png" alt="An image of HTTP response headers.">
            </picture>
          </section>
          <!-- [3.] -->
          <section data-state="centered">
            <h2><code>encodedBodySize</code></h2>
            <h3 class="lowercase">The compressed size of a resource.</h3>
            <h4 class="lowercase"><em>(Without headers.)</em></h4>
          </section>
          <!-- [3.] -->
          <section data-state="centered">
            <h2><code>decodedBodySize</code></h2>
            <h3 class="lowercase">The decompressed size of a resource.</h3>
            <h4 class="lowercase"><em>(Without headers.)</em></h4>
          </section>
          <!-- [3.] -->
          <section data-state="centered">
            <h2><code>nextHopProtocol</code></h2>
            <h3 class="lowercase">The protocol used to transmit a resource.</h3>
          </section>
          <!-- [3.] -->
          <section>
            <h3><code>nextHopProtocol</code> values*:</h3>
            <ul>
              <li class="fragment"><code>h2</code> (HTTP/2)</li>
              <li class="fragment"><code>hq</code> (QUIC)</li>
              <li class="fragment"><code>http/1.1</code></li>
            </ul>
            <h4 class="fragment lowercase"><em>*This is probably not exhaustive!</em></h4>
          </section>
        </section>
        <!-- [4.0] -->
        <section>
          <!-- [4.] -->
          <section>
            <h1 class="accent">Timing recipes!</h1>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>TTFB <span class="lowercase"><em>(ms)</em></span></h2>
            <hr>
            <pre><code class="javascript">let ttfb = responseStart - requestStart; // 35.6001 ms</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>Resource fetch time <span class="lowercase"><em>(ms)</em></span></h2>
            <hr>
            <pre><code class="javascript">let fetchTime = responseEnd - fetchStart; // 512.3021 ms</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>Fetch speed <span class="lowercase"><em>(Mbps)</em></span></h2>
            <hr>
            <pre><code class="javascript">let fetchSpeed = (
  (transferSize / (2**20)) / ((responseEnd - responseStart) / 1000)
) * 8; // 9.0012 Mbps</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>Header size <span class="lowercase"><em>(bytes)</em></span></h2>
            <hr>
            <pre><code class="javascript">let headerSize = transferSize - encodedBodySize; // 169 bytes</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>DNS lookup time <span class="lowercase"><em>(ms)</em></span></h2>
            <hr>
            <pre><code class="javascript">let dnsTime = domainLookupEnd - domainLookupStart; // 171.2999 ms</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>TCP time <span class="lowercase"><em>(ms)</em></span></h2>
            <hr>
            <pre><code class="javascript">let tcpTime = connectEnd - connectStart; // 93.5005 ms</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>SSL time <span class="lowercase"><em>(ms)</em></span></h2>
            <hr>
            <pre><code class="javascript">let sslTime = 0;

if(secureConnectionStart > 0) {
  sslTime = connectEnd - secureConnectionStart; // 58.6002 ms
}</code></pre>
          </section>
          <!-- [4.] -->
          <section data-state="centered">
            <h2>DOM processing time <span class="lowercase"><em>(ms)</em></span></h2>
            <hr>
            <pre><code class="javascript">let domTime = domComplete - domInteractive; // 276.6999 ms</code></pre>
          </section>
        </section>
        <!-- [5.0] -->
        <section>
          <!-- [5.] -->
          <section>
            <h1 class="accent">Bonus materials!</h1>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h2>Server Timing</h2>
            <h4 class="lowercase">Passes server side metrics to navigation timing.</h4>
            <h5 class="lowercase"><em><a href="https://w3c.github.io/server-timing/" rel="noopener">w3c.github.io/server-timing</a></em></h5>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h3>
              What <code>Server-Timing</code><br>
              headers look like:
            </h3>
            <picture>
              <source srcset="img/server-timing-headers-2x.webp 2x, img/server-timing-headers-1x.webp 1x" type="image/webp">
              <source srcset="img/server-timing-headers-2x.png 2x, img/server-timing-headers-1x.png 1x" type="image/png">
              <img class="stretch" src="img/server-timing-headers-1x.png" alt="An image of the server timing header.">
            </picture>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h3>
              How <code>Server-Timing</code><br>
              headers are visualized:
            </h3>
            <picture>
              <source srcset="img/server-timing-readout-2x.webp 2x, img/server-timing-readout-1x.webp 1x" type="image/webp">
              <source srcset="img/server-timing-readout-2x.png 2x, img/server-timing-readout-1x.png 1x" type="image/png">
              <img class="stretch" src="img/server-timing-readout-1x.png" alt="The visualization of server timing values in Chrome's dev tools.">
            </picture>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h2>Paint Timing API</h2>
            <h4 class="lowercase">Exposes first paint and first meaningful paint timings.</h4>
            <h5 class="lowercase"><em><a href="https://www.w3.org/TR/paint-timing/" rel="noopener">w3.org/TR/paint-timing</a></em><h5>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h3>Try it in the console*:</h3>
            <pre><code class="javascript">performance.getEntriesByType(&quot;paint&quot;).forEach((paint) => {
  console.dir(paint);
});</code></pre>
            <h5 class="lowercase fragment"><em>*Currently only in Chrome</em></h5>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h3>Paint timing metrics:</h3>
            <picture>
              <source srcset="img/paint-timing-2x.webp 2x, img/paint-timing-1x.webp 1x" type="image/webp">
              <source srcset="img/paint-timing-2x.png 2x, img/paint-timing-1x.png 1x" type="image/png">
              <img class="medium" src="img/paint-timing-1x.png" alt="Paint timing metrics in the Chrome console.">
            </picture>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h2>Long Tasks API</h2>
            <h4 class="lowercase">Logs activity that blocks the main thread for a long period of time.</h4>
            <h5 class="lowercase"><em><a href="https://w3c.github.io/longtasks/" rel="noopener">w3c.github.io/longtasks</a></em></h5>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h3>What is a &quot;long task&quot;?
            <blockquote cite="https://w3c.github.io/longtasks/#sec-terminology">
              &ldquo;<strong>Long task</strong> refers to an event loop that exceeds 50ms.&rdquo;<br>
              <cite>&mdash; <a href="https://w3c.github.io/longtasks/#sec-terminology" rel="noopener">Long Tasks Spec, &sect; 2.</a></cite>
            </blockquote>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <pre><code class="javascript">var observer = new PerformanceObserver(function(list) {
  var perfEntries = list.getEntries();
  for (var i = 0; i &lt; perfEntries.length; i++) {
    console.dir(perfEntries[i]);
  }
});

observer.observe({
  entryTypes: [&quot;longtask&quot;] // &lt;-- The good stuff
});</code></pre>
            <h5 class="lowercase fragment"><em>*Will output nothing if no long tasks are detected after initializing the observer.</em></h5>
          </section>
          <!-- [5.] -->
          <section data-state="centered">
            <h3>Long task metrics:</h3>
            <picture>
              <source srcset="img/longtask-2x.webp 2x, img/longtask-1x.webp 1x" type="image/webp">
              <source srcset="img/longtask-2x.png 2x, img/longtask-1x.png 1x" type="image/png">
              <img class="medium" src="img/longtask-1x.png" alt="Long task metrics in the Chrome console.">
            </picture>
          </section>
        </section>
        <!-- [6.0] -->
        <section>
          <!-- [6.] -->
          <section>
            <h1 class="accent">Quick tips!</h1>
          </section>
          <!-- [6.] -->
          <section data-state="centered">
            <h2>
              Don't record<br>
              computed metrics
            </h2>
            <h4 class="fragment lowercase"><em>(Unless you know what you're doing)</em></h4>
          </section>
          <!-- [6.] -->
          <section data-state="centered">
            <h2>Always feature check:</h2>
            <pre><code class="javascript">// Check if we can do performance-y things
if (&quot;performance&quot; in window) {
  if (performance.getEntriesByType("navigation").length > 0) {
    // Do things with navigation timing
  }

  if (performance.getEntriesByType("resource").length > 0) {
    // Do things with resource timing
  }

  if (performance.getEntriesByType("paint").length > 0) {
    // Do things with paint timing
  }
}</code></pre>
          </section>
          <!-- [6.] -->
          <section data-state="centered">
            <h3 class="lowercase">Gather performance metrics with</h3>
            <h2><code>PerformanceObserver</code></h2>
          </section>
          <!-- [6.] -->
          <section data-state="centered">
            <h3>Using <code>PerformanceObserver</code></h3>
            <pre><code class="javascript">var observer = new PerformanceObserver(function(list) {
  var perfEntries = list.getEntries();
  for (var i = 0; i &lt; perfEntries.length; i++) {
    // Do stuff with whatever comes in
  }
});

observer.observe({
  // Add performance entry types you want to observe here:
  entryTypes: [&quot;navigation&quot;, &quot;resource&quot;, &quot;paint&quot;, &quot;longtask&quot;]
});</code></pre>
          </section>
        </section>
        <!-- [7.0] -->
        <section>
          <!-- [7.] -->
          <section>
            <h1 class="accent">Wrapping up!</h1>
          </section>
          <!-- [7.] -->
          <section data-state="section-slide centered">
            <h1 class="accent">With thanks to:</h1>
            <div class="people">
              <div class="person">
                <img src="img/people/estelle-weyl.jpg" alt="Estelle Weyl">
                <p>
                  Estelle Weyl<br>
                  <a href="https://twitter.com/estellevw" rel="noopener">@estellevw</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/ilya-grigorik.jpg" alt="Ilya Grigorik">
                <p>
                  Ilya Grigorik<br>
                  <a href="https://twitter.com/igrigorik" rel="noopener">@igrigorik</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/shubhie-panicker.jpg" alt="Shubhie Panicker">
                <p>
                  Shubhie Panicker<br>
                  <a href="https://twitter.com/shubhie" rel="noopener">@shubhie</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/charles-vazac.jpg" alt="Charles Vazac">
                <p>
                  Charles Vazac<br>
                  <a href="https://twitter.com/vazac" rel="noopener">@vazac</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/jatinder-mann.jpg" alt="Jatinder Mann">
                <p>
                  Jatinder Mann<br>
                  <a href="https://twitter.com/jatindermann" rel="noopener">@jatindermann</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/domenic-denicola.jpg" alt="Domenic Denicola">
                <p>
                  Domenic Denicola<br>
                  <a href="https://twitter.com/domenic" rel="noopener">@domenic</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/tobin-titus.jpg" alt="Tobin Titus">
                <p>
                  Tobin Titus<br>
                  <a href="https://twitter.com/tobint" rel="noopener">@tobint</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/todd-reifsteck.jpg" alt="Todd Reifsteck">
                <p>
                  Todd Reifsteck<br>
                  <a href="https://twitter.com/toddreifsteck" rel="noopener">@toddreifsteck</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/paul-irish.jpg" alt="Paul Irish">
                <p>
                  Paul Irish<br>
                  <a href="https://twitter.com/paul_irish" rel="noopener">@paul_irish</a>
                </p>
              </div>
            </div>
          </section>
          <!-- [7.] -->
          <section data-state="centered">
            <h1 class="accent">Thanks!</h1>
            <h3 class="lowercase">
              <em>
                Slides:<br>
                <a href="http://jlwagner.net/talks/perf-timings" rel="noopener">jlwagner.net/talks/perf-timings</a>
              </em>
            </h3>
          </section>
        </section>
      </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script>
      Reveal.initialize({
        history: true,
        controls: false,
        transition: "none",
        // progress: false,
        viewDistance: 2,
        help: false,
        dependencies: [{
            src: 'plugin/notes/notes.js',
            async: true
          },
          {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function() {
              hljs.initHighlightingOnLoad();
            }
          }
        ]});
    </script>
  </body>
</html>
